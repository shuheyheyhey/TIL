#Java 変数とオブジェクト

##基本型と参照型

### 基本型  

変数そのものが値を保持する。
あえて説明するまでもなく、int とか boolean とかアレ。

### 参照型  

変数がオブジェクトを指し示す。  
`String s = new String();`  
s は String オブジェクトを参照するための変数である。  
new String() は名前のないオブジェクトを生成している。  
"参照"とはオブジェクトの位置(アドレス)を指し示すことといえる(ポインタ)。  
→"オブジェクトへの参照"と"オブジェクト"は別物であることには注意。  

##null参照

何も参照していないという概念が必要になる場合がある。  
どんな時に使うか？  
* 未初期化状態  
* オブジェクトが存在しないことを明示(フラグ)  
* 参照を明示的になくす(GC)  

null を持つ変数にアクセスすると NullPointerException が発生する。  
null チェックには `s != null` でもいいが、Objects.nonNull(T)メソッドでもチェック可能。  
明示的な null チェックを行わないようにするためには Optional 型を利用する。  
→これはまたの機会に。

## オブジェクトの寿命

オブジェクトへの参照が完全になくなったとき(参照数が 0 になった時)、ガベージコレクションによって回収される。  
参照が消滅するのは以下のとき。  
* ローカルおよびパラメータ変数のスコープが外れた時  
* オブジェクトが消滅した時、インスタンスフィールド変数から参照が外れた時  
* クラスが消滅した時、そのクラスのクラスフィールド変数から参照が外れた時   
* 変数に別オブジェクトの参照または、null を代入した時(以前の参照が外れる)  
* メソッドチェーンで参照させている場合に式の評価が完了した時  

## final変数と不変オブジェクト

final修飾子をつけた変数は再代入不可となる。  

基本型の場合は読み込み専用となり、再代入を行うとコンパイルエラーになる。  

参照型の場合は再代入を行なってもコンパイルエラーにはならない。  
参照するオブジェクトを変更することはできないが、参照しているオブジェクト自体を変更できないとうわけではない。  

```java:sample.java
StringBuilder sb = new StringBuilder("abc");
sb.append("def"); // OK
sb = new StringBuilder("ghi"); // コンパイルエラー
```

もし内容の変更そのものも禁止したい場合は不変オブジェクトを使用する。 